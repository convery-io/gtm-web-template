___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Convery",
  "categories": ["ANALYTICS"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Configuration tag template for convery.io",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "tenant",
    "displayName": "Property id",
    "simpleValueType": true,
    "valueHint": "XXXX-XXXX-XXXX-XXXX",
    "alwaysInSummary": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "stream_id",
    "displayName": "Data stream id",
    "simpleValueType": true,
    "defaultValue": 1,
    "alwaysInSummary": true
  },
  {
    "type": "GROUP",
    "name": "event_info",
    "displayName": "Event settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SELECT",
        "name": "event_category",
        "displayName": "Category",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "default",
            "displayValue": "Defaul"
          },
          {
            "value": "custom",
            "displayValue": "Custom"
          }
        ],
        "simpleValueType": true
      },
      {
        "type": "SELECT",
        "name": "event_type",
        "displayName": "Type",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "page_view",
            "displayValue": "page_view"
          },
          {
            "value": "add_to_cart",
            "displayValue": "add_to_cart"
          },
          {
            "value": "select_item",
            "displayValue": "select_item"
          },
          {
            "value": "view_item",
            "displayValue": "view_item"
          },
          {
            "value": "begin_checkout",
            "displayValue": "begin_checkout"
          },
          {
            "value": "add_payment_info",
            "displayValue": "add_payment_info"
          },
          {
            "value": "add_shipping_info",
            "displayValue": "add_shipping_info"
          },
          {
            "value": "view_promotion",
            "displayValue": "view_promotion"
          },
          {
            "value": "select_promotion",
            "displayValue": "select_promotion"
          },
          {
            "value": "view_item_list",
            "displayValue": "view_item_list"
          },
          {
            "value": "view_cart",
            "displayValue": "view_cart"
          },
          {
            "value": "add_to_wishlist",
            "displayValue": "add_to_wishlist"
          },
          {
            "value": "remove_from_cart",
            "displayValue": "remove_from_cart"
          },
          {
            "value": "purchase",
            "displayValue": "purchase"
          }
        ],
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "event_category",
            "paramValue": "default",
            "type": "EQUALS"
          }
        ],
        "help": "See convery.io documentations"
      },
      {
        "type": "CHECKBOX",
        "name": "event_use_override_name",
        "checkboxText": "Use custom event name",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "event_category",
            "paramValue": "default",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "event_override_name",
        "displayName": "Custom event Name",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "event_use_override_name",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "event_custom_name",
        "displayName": "Custom event name",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "event_category",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "event_use_datalayer",
        "checkboxText": "Use GA4 datalayer",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "event_category",
            "paramValue": "default",
            "type": "EQUALS"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "event_data_info",
    "displayName": "Event data",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "GROUP",
        "name": "ecommece_data",
        "displayName": "Ecommerce",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "TEXT",
            "name": "event_data_item",
            "displayName": "Items object",
            "simpleValueType": true,
            "enablingConditions": [],
            "alwaysInSummary": false
          },
          {
            "type": "TEXT",
            "name": "event_data_item_list_id",
            "displayName": "Item list id",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "select_item",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              },
              {
                "paramName": "event_type",
                "paramValue": "view_item_list",
                "type": "EQUALS"
              }
            ],
            "alwaysInSummary": false
          },
          {
            "type": "TEXT",
            "name": "event_data_item_list_name",
            "displayName": "Item list name",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "view_item_list",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "select_item",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ],
            "alwaysInSummary": false
          },
          {
            "type": "TEXT",
            "name": "event_data_currency",
            "displayName": "Currency",
            "simpleValueType": true,
            "enablingConditions": []
          },
          {
            "type": "TEXT",
            "name": "event_data_value",
            "displayName": "Value",
            "simpleValueType": true,
            "enablingConditions": []
          },
          {
            "type": "TEXT",
            "name": "event_data_transaction_id",
            "displayName": "transaction id",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "purchase",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "event_data_shipping_value",
            "displayName": "Shipping value",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "purchase",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "event_data_tax",
            "displayName": "Tax value",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "purchase",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "event_data_coupon",
            "displayName": "Coupon",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "purchase",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "event_data_shipping_tier",
            "displayName": "Shipping tier",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "add_shipping_info",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "event_data_payment_type",
            "displayName": "Payment type",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "event_type",
                "paramValue": "add_payment_info",
                "type": "EQUALS"
              },
              {
                "paramName": "event_type",
                "paramValue": "",
                "type": "IS_MACRO_REFERENCE"
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "event_use_datalayer",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "promotion_data",
        "displayName": "Promotion",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "TEXT",
            "name": "event_data_creative_name",
            "displayName": "Creative name",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "event_data_creative_slot",
            "displayName": "Creative slot",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "event_data_location_id",
            "displayName": "Location id",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "event_data_promotion_id",
            "displayName": "Promotion id",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "event_data_promotion_name",
            "displayName": "Promotion name",
            "simpleValueType": true
          }
        ],
        "enablingConditions": [
          {
            "paramName": "event_use_datalayer",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "LABEL",
        "name": "vp_message",
        "displayName": "No data needed",
        "enablingConditions": [
          {
            "paramName": "event_use_datalayer",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "page_view",
        "type": "NOT_EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "event_custom_params",
    "displayName": "Custom parameters",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "customParamsList",
        "displayName": "",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Name",
            "name": "name",
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "Value",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "newRowButtonText": "Add parameter"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "other_settings",
    "displayName": "Other settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "GROUP",
        "name": "cookie",
        "displayName": "Cookie consent",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "SELECT",
            "name": "user_consent",
            "displayName": "Cookie consent (GDPR)",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": true,
                "displayValue": "true"
              },
              {
                "value": false,
                "displayValue": "false"
              }
            ],
            "simpleValueType": true,
            "notSetText": "Non impostato",
            "defaultValue": false,
            "enablingConditions": []
          }
        ],
        "enablingConditions": []
      },
      {
        "type": "GROUP",
        "name": "bedug_event",
        "displayName": "Convery Debug",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "LABEL",
            "name": "info",
            "displayName": "Attention! Use this function only during configuration."
          },
          {
            "type": "CHECKBOX",
            "name": "debug",
            "checkboxText": "Active Convery debugger",
            "simpleValueType": true
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');
const copyFromDataLayer = require('copyFromDataLayer');
const makeTableMap = require('makeTableMap');
const convery = require('callInWindow'); 
const JSON = require('JSON');
const getUrl = require('getUrl');
const getReferrerUrl = require('getReferrerUrl');
const readTitle = require('readTitle');
const math = require('Math');
const random = require('generateRandom');
const date = require('getTimestampMillis');

//data from models
const event_category = data.event_category;
var event_type = data.event_type;
const event_use_override_name = data.event_use_override_name;
const event_override_name = data.event_override_name;
const use_datalayer = data.event_use_datalayer;
const event_custom_name = data.event_custom_name;
const ecommerce = copyFromDataLayer('ecommerce');
const customParams = data.customParamsList && data.customParamsList.length ? makeTableMap(data.customParamsList, 'name', 'value') : {};
const lib = "https://libs.convery.io/analytics.js";

const onSuccess = () => { 
  if (event_type == "gtm.js"){ event_type = "page_view";}  
  g_sendData(event_type);
  data.gtmOnSuccess();
};

const onFailure = () => { 
  log("Fail to load Convery library");
  data.gtmOnFailure();
};

function g_sendData(events) {
  var event_data, raw_data;
  var base_data = { "source_id": data.stream_id, "cookie_consent": data.user_consent, "debug":(data.debug) ? true : false };
  var content_data = g_content();
  
  if (event_category == "default" && event_use_override_name == false){
      event_data ={"action":{"type": "" + event_type + "", "name": ""}};
  } else if (event_use_override_name == true && event_category == "default") {
      event_data = {"action":{"type": "" + event_type + "","name": "" + event_override_name +""}};
  }else if (event_category == "custom"){
      event_data = {"action":{"type": "" + event_category + "","name": "" + event_custom_name + ""}};
  }
  raw_data = g_arrayMerge(base_data, event_data, content_data);   
  convery('c_readData', raw_data, data.tenant, base_data);  
}

function g_arrayMerge() {
  var r = {};
  var l = arguments.length;
  for (var i = 0; i < l; i++) {
    for (var p in arguments[i]) {
      if (arguments[i].hasOwnProperty(p)) { r[p] = arguments[i][p];}
    }
  } 
  return r;
}

function g_anonymizeTransaction(){
  var dt, r, tid;
  if (data.user_consent == false){
    dt = date();
    r = (random(dt,1000));
    r = math.floor(r/1000);
    tid = 'C' + r.toString();
  } else {
    tid = (use_datalayer) ? ecommerce.transaction_id : data.event_data_transaction_id;
  }
  return tid;
}

function g_content (){    
  var content, ready_data;
  if (event_category == "default"){            
  switch (event_type){
    case "page_view":
        content = {
        "page_title": "" + readTitle() +"",
	      "page_location": "" + getUrl() + "",
	      "page_path": "" + getUrl("path") + "",
	      "page_referrer": "" + getReferrerUrl() + ""     
        };
    break;  
    case "purchase":
        content ={
          "transaction_id": g_anonymizeTransaction(),
          "affiliation": "" + data.stream_id + "",
          "tax": (use_datalayer) ? ecommerce.tax : data.event_data_tax, 
          "shipping": (use_datalayer) ? ecommerce.shipping : data.event_data_shipping_value,
          "coupon": (use_datalayer) ? ecommerce.coupon : data.event_data_coupon,
          "items": (use_datalayer) ? ecommerce.items : data.event_data_item,
          "currency": (use_datalayer) ? ecommerce.currency : data.event_data_currency,
          "value": (use_datalayer) ? ecommerce.value : data.event_data_value
        };
  	break;
    case "add_shipping_info":
    	content ={
          "coupon": (use_datalayer) ? ecommerce.coupon : data.event_data_coupon,
          "shipping_tier": (use_datalayer) ? ecommerce.shipping_tier : data.event_data_shipping_tier,
          "items": (use_datalayer) ? ecommerce.items : data.event_data_item,
          "currency": (use_datalayer) ? ecommerce.currency : data.event_data_currency,
          "value": (use_datalayer) ? ecommerce.value : data.event_data_value
        };
    break;
    case "add_payment_info":
    	content ={
          "coupon": (use_datalayer) ? ecommerce.coupon : data.event_data_coupon,
          "payment_type": (use_datalayer) ? ecommerce.payment_type : data.event_data_payment_type,
          "items": (use_datalayer) ? ecommerce.items : data.event_data_item,
          "currency": (use_datalayer) ? ecommerce.currency : data.event_data_currency,
          "value": (use_datalayer) ? ecommerce.value : data.event_data_value
        };
    break;
	case "select_item": case "view_item_list":
		content = {
         "items": (use_datalayer) ? ecommerce.items : data.event_data_item,
         "item_list_id": (use_datalayer) ? ecommerce.item_list_id : data.event_data_item_list_id,
         "item_list_name": (use_datalayer) ? ecommerce.item_list_name : data.event_data_item_list_name
        };
    break;
    case "view_promotion": case "select_promotion":
    	content = {
        	"creative_name": (use_datalayer) ? ecommerce.creative_name : data.event_data_creative_name,
            "creative_slot": (use_datalayer) ? ecommerce.creative_slot : data.event_data_creative_slot,
            "location_id": (use_datalayer) ? ecommerce.location_id : data.event_data_location_id,
            "promotion_id": (use_datalayer) ? ecommerce.promotion_id : data.event_data_promotion_id,
            "promotion_name": (use_datalayer) ? ecommerce.promotion_name : data.event_data_promotion_name,
            "items": (use_datalayer) ? ecommerce.items : data.event_data_item    
        };
    break;
    default:
    	content = {    
        	"items": (use_datalayer) ? ecommerce.items : data.event_data_item,
            "currency": (use_datalayer) ? ecommerce.currency : data.event_data_currency,
            "value": (use_datalayer) ? ecommerce.value : data.event_data_value
	};
  }}
      if (customParams.length != 'undefined'){ content = g_arrayMerge(content, customParams); }
      ready_data = {"event": content};
      return ready_data; 
}

injectScript(lib, onSuccess, onFailure, 'Convery');
//data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "c_readData"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "gtm.event"
              },
              {
                "type": 1,
                "string": "ecommerce"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://libs.convery.io/analytics.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_title",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Untitled test 1
  code: |-
    const mockData = {
      // Mocked field values
    };

    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();


___NOTES___

Created on 28/4/2023, 17:18:09


